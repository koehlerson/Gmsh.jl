<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial 16 Â· Gmsh API for Julia</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">Gmsh API for Julia</span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../t1/">Tutorial 1</a></li><li><a class="tocitem" href="../t2/">Tutorial 2</a></li><li><a class="tocitem" href="../t3/">Tutorial 3</a></li><li><a class="tocitem" href="../t4/">Tutorial 4</a></li><li><a class="tocitem" href="../t5/">Tutorial 5</a></li><li><a class="tocitem" href="../t10/">Tutorial 10</a></li></ul></li><li><span class="tocitem">Built-in Geometry Kernel</span><ul><li><a class="tocitem" href="../../geo/geometry/">Geometry</a></li><li><a class="tocitem" href="../../geo/mesh/">Mesh Constraints</a></li></ul></li><li><span class="tocitem">Model</span><ul><li><a class="tocitem" href="../../model/model/">Model</a></li><li><a class="tocitem" href="../../model/mesh/">Meshing</a></li></ul></li><li><a class="tocitem" href="../../options/options/">Options</a></li><li><a class="tocitem" href="../../occ/occ/">OpenCASCADE Kernel</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial 16</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial 16</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Tutorial-16"><a class="docs-heading-anchor" href="#Tutorial-16">Tutorial 16</a><a id="Tutorial-16-1"></a><a class="docs-heading-anchor-permalink" href="#Tutorial-16" title="Permalink"></a></h1><h2 id="Constructive-Solid-Geometry,-OpenCASCADE-geometry-kernel"><a class="docs-heading-anchor" href="#Constructive-Solid-Geometry,-OpenCASCADE-geometry-kernel">Constructive Solid Geometry, OpenCASCADE geometry kernel</a><a id="Constructive-Solid-Geometry,-OpenCASCADE-geometry-kernel-1"></a><a class="docs-heading-anchor-permalink" href="#Constructive-Solid-Geometry,-OpenCASCADE-geometry-kernel" title="Permalink"></a></h2><p>Instead of constructing a model in a bottom-up fashion with Gmsh&#39;s built-in geometry kernel, starting with version 3 Gmsh allows you to directly use alternative geometry kernels. Here we will use the OpenCASCADE kernel.</p><pre><code class="language-julia">import gmsh</code></pre><pre><code class="language-julia">gmsh.initialize()</code></pre><pre><code class="language-julia">gmsh.model.add(&quot;t16&quot;)</code></pre><p>Let&#39;s build the same model as in `t5.py&#39;, but using constructive solid geometry. We first create two cubes:</p><pre><code class="language-">gmsh.model.occ.addBox(0,0,0, 1,1,1, 1)
gmsh.model.occ.addBox(0,0,0, 0.5,0.5,0.5, 2)</code></pre><p>We apply a boolean difference to create the &quot;cube minus one eigth&quot; shape:</p><pre><code class="language-">gmsh.model.occ.cut([(3,1)], [(3,2)], 3)</code></pre><p>Boolean operations with OpenCASCADE always create new entities. By default the extra arguments <code>removeObject&#39; and</code>removeTool&#39; in <code>cut()&#39; are set to</code>True&#39;, which will delete the original entities.</p><p>We then create the five spheres:</p><pre><code class="language-julia">x = 0; y = 0.75; z = 0; r = 0.09</code></pre><pre class="documenter-example-output">0.09</pre><pre><code class="language-">holes = []
for t in 1:5
    global x, z
    x += 0.166
    z += 0.166
    gmsh.model.occ.addSphere(x,y,z,r, 3 + t)
    t = (3, 3 + t)
    push!(holes, t)
end</code></pre><p>If we had wanted five empty holes we would have used <code>cut()&#39; again. Here we want five spherical inclusions, whose mesh should be conformal with the mesh of the cube: we thus use</code>fragment()&#39;, which intersects all volumes in a conformal manner (without creating duplicate interfaces):</p><pre><code class="language-">ov = gmsh.model.occ.fragment([(3,3)], holes)
gmsh.model.occ.synchronize()</code></pre><p>Creating entities using constructive solid geometry is very powerful, but can lead to practical issues for e.g. setting mesh sizes at points, or identifying boundaries.</p><p>To identify points or other bounding entities you can take advantage of the <code>getEntities()&#39;,</code>getBoundary()&#39; and `getEntitiesInBoundingBox()&#39; functions:</p><pre><code class="language-julia">lcar1 = .1
lcar2 = .0005
lcar3 = .055</code></pre><pre class="documenter-example-output">0.055</pre><p>Assign a mesh size to all the points:</p><pre><code class="language-julia">ov = gmsh.model.getEntities(0);
gmsh.model.mesh.setSize(ov, lcar1);</code></pre><p>Override this constraint on the points of the five spheres:</p><pre><code class="language-julia">ov = gmsh.model.getBoundary(holes, false, false, true);
gmsh.model.mesh.setSize(ov, lcar3);</code></pre><p>Select the corner point by searching for it geometrically:</p><pre><code class="language-julia">eps = 1e-3
ov = gmsh.model.getEntitiesInBoundingBox(0.5-eps, 0.5-eps, 0.5-eps,
                                         0.5+eps, 0.5+eps, 0.5+eps, 0)
gmsh.model.mesh.setSize(ov, lcar2)</code></pre><pre><code class="language-julia">gmsh.model.mesh.generate(3)</code></pre><pre class="documenter-example-output">Info    : Meshing 1D...
Info    : Done meshing 1D (Wall 3.1e-06s, CPU 5e-06s)
Info    : Meshing 2D...
Info    : Done meshing 2D (Wall 5.601e-06s, CPU 5e-06s)
Info    : Meshing 3D...
Info    : Done meshing 3D (Wall 1.04e-05s, CPU 1e-05s)
Info    : 0 nodes 0 elements</pre><pre><code class="language-julia">gmsh.write(&quot;t16.msh&quot;)</code></pre><pre class="documenter-example-output">Info    : Writing &#39;t16.msh&#39;...
Info    : Done writing &#39;t16.msh&#39;</pre><pre><code class="language-julia">gmsh.finalize()</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 3 January 2021 12:26">Sunday 3 January 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
